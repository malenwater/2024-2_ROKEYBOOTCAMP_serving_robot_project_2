# 2024-2_ROKEYBOOTCAMP_serving_robot_project_2
본 프로젝트는 ROS2를 활용하여 재난 구조 로봇을 개발하고, Mapping, 탐색, 객체 탐지(Detection) 및 좌표 변환을 통한 맵 반영을 구현하는 것을 목표로 합니다.

## ✨ Key Features

- **동적 탐색 알고리즘**:  <br/>
  로봇이 SLAM으로 생성된 지도에서 가장 먼 미지의 영역을 식별하고 순차적으로 탐색합니다.
- **파라미터 최적화**:  <br/>
  좁은 경로에서도 원활한 탐색이 가능하도록 매개변수를 조정했습니다.
- **효율적인 커버리지**:  <br/>
  불필요한 중복을 최소화하면서 모든 미지의 공간을 탐색합니다.
- **PnP 기반 위치 식별, TR 변환으로 SLAM 맵 좌표 변환**: <br/>
  TR 변환과 PNP를 활용하면 SLAM 맵 기준 -> base_link → camera → 소화기/사람의 위치를 변환할 수 있다.

## 진행한 프로젝트 리뷰
 - **로봇 청소기 오토 맵핑** <br/>
   turtleBot4의 slam과 nav2 기능을 이용해서 폭이 일정한 환경에서 자동으로 맵핑이 되도록 한다. 좁은 곳을 통과하기 위한 slam, nav2 튜닝과 점을 찍기 위한 이동 로직이 중요하다.
   <br/>
    - slam, nav2의 파라미터 튜닝을 통해서, 좁은 곳과 벽 뒤에 넘어가는 경우, 맵이 깨지는 경우 등을 해낼 수 있다. <br/>
    - nav2가 올바른 이동을 위해서 밝혀지지 않은 공간(-1), 밝혀진 공간(0), 벽(100) 중 이동 가능한 밝혀지지 않은 공간의 옆 밝혀진 공간으로 충분히 이동 가능할 경우, nav2를 찍도록 하는 로직을 수행한다. <br/>
 - **PNP를 통한 slam map에 물체 위치 나타내기**
   PNP란 3D 현실 좌표계를 카메라상 2D 이미지 위치를 보고, 카메라가 해당 점까지의 좌표계(TR)을 추리해주는 알고리즘이다. 이를 활용하여 로봇으로 부터 인지한 이미지(소화기, 쓰러진 사람)을 디텍팅하고 해당 이미지의 위치를 slam map에 띄우도록 한다.
   - 핵심 개념으로 slam map 좌표계 기준 base_link pose TR과 base_link 좌표계 기준 camera pose TR과 camera 좌표계 기준 img pose TR(PNP)를 각각 구하여 연산하여 구하는 것이 중요하다. 

## 겪었던 문제사항과 해결 방법들
  - slam map이 auto mapping 중 부셔지는 문제(튜닝 문제)
  - nav2의 이동이 벽 뒤를 찍을 경우, 이동하지 못하는 문제(튜닝 문제)
  - nav2의 이동이 좁은 곳을 찍을 경우, 이동하지 못하는 문제 (튜닝 문제)
  - PNP의 로직은 맞지만, 계속해서 벽이 아닌 벽 앞에 이미지가 있다고 인식하는 문제 (PNP 문제)

## 🎥 Demo Video
- [터틀봇4 자동 맵핑 영상](https://youtu.be/OAdRA_p5VME)
- [소화기 및 쓰러진 사람 이미지 위치 영상](https://youtube.com/shorts/we-peWtMpCA?feature=share)

## 해당 프로젝트의 문제점과 해결방안
|이름|문제점|해결 방안|역할|
|---|---|---|---|
|이선우|1. pnp 로직은 맞지만 벽에 붙어있는 이미지가 벽 앞에 있는 것으로 나오는 문제가 있었다.|1. 해당 문제는 알고리즘 상으론 몇 번을 검토를 해보아도 문제가 없었습니다. 그래서 강사님께 도움을 청했고, 해당 문제에 관해서 강사님은 다른 1기와 전 그룹에서도 동일한 현상이 있었다고 했습니다. 그래서 저는 계속해서 왜 그런지를 고민하였고, 강사님과 함께, 로봇에서 제공해주는 |pnp 알고리즘 설계 및 코딩, 터틀봇4 튜닝|
|이강태|더미123|더미|pnp 알고리즘 설계 및 코딩, 터틀봇4 튜닝|
|최민호|더미|더미|pnp 알고리즘 설계 및 코딩, 터틀봇4 경로 로직 설계 및 코딩|
|류승기|더미|더미|pnp 알고리즘 설계 및 코딩, 터틀봇4 경로 로직 설계 및 코딩|
|정승연|더미|더미|pnp 알고리즘 설계 및 코딩, 터틀봇4 경로 로직 설계 및 코딩|
